<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="مولد كلمات مرور آمنة وقوية - Secure Password Generator">
  <title>SecurePass Pro | مولد كلمات مرور آمنة</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* متغيرات التصميم */
    :root {
      --primary: #2563eb;
      --primary-dark: #1d4ed8;
      --secondary: #7c3aed;
      --success: #10b981;
      --warning: #f59e0b;
      --danger: #ef4444;
      --dark: #0f172a;
      --darker: #020617;
      --light: #f8fafc;
      --gray: #64748b;
      --border-radius: 12px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
      --glow: 0 0 20px rgba(37, 99, 235, 0.3);
    }

    [dir="ltr"] {
      --font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
    }

    [dir="rtl"] {
      --font-family: 'Segoe UI', 'Noto Sans Arabic', -apple-system, sans-serif;
    }

    /* إعادة الضبط */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: var(--font-family);
    }

    body {
      background: linear-gradient(135deg, var(--darker), #1e293b);
      color: var(--light);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      line-height: 1.6;
      transition: var(--transition);
    }

    /* الحاوية الرئيسية */
    .container {
      background: rgba(15, 23, 42, 0.9);
      backdrop-filter: blur(20px);
      border-radius: var(--border-radius);
      padding: 40px;
      width: 100%;
      max-width: 800px;
      box-shadow: var(--shadow), var(--glow);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: var(--transition);
    }

    /* الرأس */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.1);
    }

    .header-content {
      flex: 1;
    }

    .header h1 {
      font-size: 32px;
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 800;
      margin-bottom: 8px;
    }

    .subtitle {
      color: var(--gray);
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .subtitle i {
      color: var(--success);
    }

    /* مبدل اللغة */
    .language-switcher {
      display: flex;
      gap: 10px;
      background: rgba(255, 255, 255, 0.05);
      padding: 8px;
      border-radius: 50px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .lang-btn {
      padding: 10px 20px;
      border: none;
      border-radius: 50px;
      background: transparent;
      color: var(--gray);
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .lang-btn:hover {
      color: var(--light);
      background: rgba(255, 255, 255, 0.1);
    }

    .lang-btn.active {
      background: var(--primary);
      color: white;
      box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
    }

    /* محتوى الموقع */
    .content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
    }

    @media (max-width: 768px) {
      .content {
        grid-template-columns: 1fr;
      }
      .container {
        padding: 25px;
      }
      .header {
        flex-direction: column;
        gap: 20px;
        text-align: center;
      }
    }

    /* قسم التحكم */
    .control-section {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .control-group {
      background: rgba(255, 255, 255, 0.03);
      border-radius: var(--border-radius);
      padding: 20px;
      border: 1px solid rgba(255, 255, 255, 0.08);
      transition: var(--transition);
    }

    .control-group:hover {
      border-color: rgba(37, 99, 235, 0.3);
    }

    .control-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
      font-weight: 600;
      color: var(--light);
    }

    .control-title i {
      color: var(--primary);
      font-size: 18px;
    }

    /* خيارات التحكم */
    .option-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }

    .option-row:last-child {
      border-bottom: none;
    }

    .option-label {
      display: flex;
      align-items: center;
      gap: 10px;
      cursor: pointer;
      font-weight: 500;
      color: var(--light);
    }

    /* شريط التمرير */
    .slider-container {
      margin-top: 20px;
    }

    .slider-header {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }

    .slider-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
      background: rgba(37, 99, 235, 0.1);
      padding: 4px 12px;
      border-radius: 20px;
      min-width: 60px;
      text-align: center;
    }

    .range-slider {
      width: 100%;
      height: 8px;
      border-radius: 4px;
      background: rgba(255, 255, 255, 0.1);
      outline: none;
      -webkit-appearance: none;
    }

    .range-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--primary);
      cursor: pointer;
      border: 3px solid white;
      box-shadow: 0 0 15px rgba(37, 99, 235, 0.5);
      transition: var(--transition);
    }

    .range-slider::-webkit-slider-thumb:hover {
      transform: scale(1.1);
      box-shadow: 0 0 20px rgba(37, 99, 235, 0.7);
    }

    /* شريط القوة */
    .strength-meter {
      margin: 25px 0;
    }

    .strength-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .strength-label {
      font-weight: 600;
      color: var(--light);
    }

    .strength-value {
      font-weight: 700;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 14px;
    }

    .strength-bar {
      height: 10px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 8px;
    }

    .strength-fill {
      height: 100%;
      width: 0%;
      border-radius: 5px;
      transition: width 0.5s ease;
    }

    .strength-text {
      font-size: 12px;
      color: var(--gray);
      text-align: right;
    }

    /* عرض كلمة المرور */
    .password-section {
      display: flex;
      flex-direction: column;
    }

    .password-display {
      background: rgba(0, 0, 0, 0.3);
      border: 2px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--border-radius);
      padding: 25px;
      font-size: 22px;
      text-align: center;
      word-break: break-all;
      direction: ltr;
      font-family: 'Courier New', monospace;
      font-weight: 700;
      letter-spacing: 1px;
      min-height: 140px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }

    .password-display::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
    }

    .password-placeholder {
      color: var(--gray);
      opacity: 0.7;
    }

    /* الأزرار */
    .action-buttons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-top: 10px;
    }

    .btn {
      padding: 16px 24px;
      border: none;
      border-radius: var(--border-radius);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
    }

    .btn-secondary {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: var(--light);
    }

    .btn-secondary:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.2);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--success), #0da271);
      color: white;
      box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
    }

    /* خيارات متقدمة */
    .advanced-options {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .advanced-toggle {
      display: flex;
      align-items: center;
      gap: 10px;
      color: var(--gray);
      cursor: pointer;
      font-weight: 500;
      margin-bottom: 15px;
    }

    .advanced-toggle i {
      transition: transform 0.3s ease;
    }

    .advanced-content {
      overflow: hidden;
      max-height: 0;
      transition: max-height 0.5s ease;
    }

    .advanced-content.show {
      max-height: 300px;
    }

    /* مقياس الأمان */
    .security-indicators {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-top: 20px;
    }

    .security-item {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 14px;
    }

    .security-item i {
      color: var(--success);
    }

    .security-item.warning i {
      color: var(--warning);
    }

    /* التذييل */
    .footer {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
      color: var(--gray);
      font-size: 14px;
    }

    .footer a {
      color: var(--primary);
      text-decoration: none;
      transition: var(--transition);
    }

    .footer a:hover {
      text-decoration: underline;
    }

    /* تأثيرات التحقق */
    .checkbox {
      width: 22px;
      height: 22px;
      border-radius: 6px;
      border: 2px solid var(--gray);
      background: transparent;
      cursor: pointer;
      position: relative;
      transition: var(--transition);
    }

    .checkbox.checked {
      background: var(--primary);
      border-color: var(--primary);
    }

    .checkbox.checked::after {
      content: '✓';
      position: absolute;
      color: white;
      font-size: 14px;
      font-weight: bold;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    /* إشعارات */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: var(--success);
      color: white;
      padding: 15px 25px;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 1000;
      transform: translateX(150%);
      transition: transform 0.3s ease;
    }

    .notification.show {
      transform: translateX(0);
    }

    .notification.error {
      background: var(--danger);
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- الرأس -->
    <div class="header">
      <div class="header-content">
        <h1 id="app-title">SecurePass Pro</h1>
        <div class="subtitle">
          <i class="fas fa-shield-alt"></i>
          <span id="app-subtitle">مولد كلمات مرور آمنة وقوية</span>
        </div>
      </div>
      <div class="language-switcher">
        <button class="lang-btn active" data-lang="ar">
          <i class="fas fa-language"></i>
          <span>العربية</span>
        </button>
        <button class="lang-btn" data-lang="en">
          <i class="fas fa-language"></i>
          <span>English</span>
        </button>
      </div>
    </div>

    <!-- المحتوى الرئيسي -->
    <div class="content">
      <!-- قسم التحكم -->
      <div class="control-section">
        <div class="control-group">
          <div class="control-title">
            <i class="fas fa-sliders-h"></i>
            <span id="settings-title">إعدادات كلمة المرور</span>
          </div>
          
          <div class="option-row">
            <label class="option-label">
              <div class="checkbox checked" data-setting="lowercase"></div>
              <span id="lowercase-label">أحرف صغيرة (a-z)</span>
            </label>
          </div>

          <div class="option-row">
            <label class="option-label">
              <div class="checkbox checked" data-setting="uppercase"></div>
              <span id="uppercase-label">أحرف كبيرة (A-Z)</span>
            </label>
          </div>

          <div class="option-row">
            <label class="option-label">
              <div class="checkbox checked" data-setting="numbers"></div>
              <span id="numbers-label">أرقام (0-9)</span>
            </label>
          </div>

          <div class="option-row">
            <label class="option-label">
              <div class="checkbox checked" data-setting="symbols"></div>
              <span id="symbols-label">رموز خاصة (!@#$%)</span>
            </label>
          </div>
        </div>

        <!-- طول كلمة المرور -->
        <div class="control-group">
          <div class="control-title">
            <i class="fas fa-ruler-horizontal"></i>
            <span id="length-title">طول كلمة المرور</span>
          </div>
          <div class="slider-container">
            <div class="slider-header">
              <span id="length-label">الطول:</span>
              <span class="slider-value" id="length-value">16</span>
            </div>
            <input type="range" class="range-slider" id="length-slider" min="8" max="32" value="16" step="1">
          </div>
        </div>

        <!-- مؤشر القوة -->
        <div class="control-group">
          <div class="control-title">
            <i class="fas fa-bolt"></i>
            <span id="strength-title">قوة كلمة المرور</span>
          </div>
          <div class="strength-meter">
            <div class="strength-header">
              <span class="strength-label" id="strength-label">القوة:</span>
              <span class="strength-value" id="strength-text">متوسطة</span>
            </div>
            <div class="strength-bar">
              <div class="strength-fill" id="strength-bar"></div>
            </div>
            <div class="strength-text" id="strength-desc">كلمة مرور جيدة، يمكن تحسينها</div>
          </div>
        </div>

        <!-- خيارات متقدمة -->
        <div class="advanced-options">
          <div class="advanced-toggle" id="advanced-toggle">
            <i class="fas fa-chevron-down"></i>
            <span id="advanced-title">خيارات متقدمة</span>
          </div>
          <div class="advanced-content" id="advanced-content">
            <div class="option-row">
              <label class="option-label">
                <div class="checkbox" data-setting="excludeSimilar"></div>
                <span id="exclude-similar-label">استبعاد الأحرف المتشابهة (i, l, 1, 0, o)</span>
              </label>
            </div>
            <div class="option-row">
              <label class="option-label">
                <div class="checkbox" data-setting="avoidDuplicates"></div>
                <span id="avoid-duplicates-label">تجنب الأحرف المكررة</span>
              </label>
            </div>
            <div class="option-row">
              <label class="option-label">
                <div class="checkbox" data-setting="startWithLetter"></div>
                <span id="start-letter-label">بداية كلمة المرور بحرف</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- قسم عرض النتائج -->
      <div class="password-section">
        <div class="password-display" id="password-display">
          <span class="password-placeholder" id="password-placeholder">سيتم عرض كلمة المرور هنا</span>
          <span id="password-text"></span>
        </div>

        <!-- مؤشرات الأمان -->
        <div class="security-indicators">
          <div class="security-item">
            <i class="fas fa-check-circle"></i>
            <span id="security-1">توليد آمن</span>
          </div>
          <div class="security-item">
            <i class="fas fa-check-circle"></i>
            <span id="security-2">تشفير قوي</span>
          </div>
          <div class="security-item warning">
            <i class="fas fa-clock"></i>
            <span id="security-3">لا يتم التخزين</span>
          </div>
          <div class="security-item">
            <i class="fas fa-check-circle"></i>
            <span id="security-4">مقاوم للهجمات</span>
          </div>
        </div>

        <!-- أزرار التحكم -->
        <div class="action-buttons">
          <button class="btn btn-primary" id="generate-btn">
            <i class="fas fa-key"></i>
            <span id="generate-text">توليد كلمة مرور</span>
          </button>
          <button class="btn btn-secondary" id="regenerate-btn">
            <i class="fas fa-redo"></i>
            <span id="regenerate-text">توليد جديدة</span>
          </button>
        </div>
        <button class="btn btn-success" id="copy-btn" style="margin-top: 15px;">
          <i class="far fa-copy"></i>
          <span id="copy-text">نسخ كلمة المرور</span>
        </button>
      </div>
    </div>

    <!-- التذييل -->
    <div class="footer">
      <p id="footer-text">
        <i class="fas fa-lock"></i>
        جميع كلمات المرور يتم توليدها على جهازك ولا يتم إرسالها إلى أي خادم. هذا الموقع مفتوح المصدر وآمن بنسبة 100%.
        <a href="#" id="learn-more">تعرف على المزيد</a>
      </p>
    </div>
  </div>

  <!-- إشعارات -->
  <div class="notification" id="notification">
    <i class="fas fa-check-circle"></i>
    <span id="notification-text">تم النسخ بنجاح!</span>
  </div>

  <script>
    // بيانات اللغات
    const translations = {
      ar: {
        appTitle: "SecurePass Pro",
        appSubtitle: "مولد كلمات مرور آمنة وقوية",
        settingsTitle: "إعدادات كلمة المرور",
        lowercaseLabel: "أحرف صغيرة (a-z)",
        uppercaseLabel: "أحرف كبيرة (A-Z)",
        numbersLabel: "أرقام (0-9)",
        symbolsLabel: "رموز خاصة (!@#$%)",
        lengthTitle: "طول كلمة المرور",
        lengthLabel: "الطول:",
        strengthTitle: "قوة كلمة المرور",
        strengthLabel: "القوة:",
        strengthWeak: "ضعيفة",
        strengthMedium: "متوسطة",
        strengthStrong: "قوية",
        strengthVeryStrong: "قوية جداً",
        strengthDescWeak: "غير آمنة - يرجى زيادة الطول والإعدادات",
        strengthDescMedium: "جيدة، يمكن تحسينها",
        strengthDescStrong: "قوية وآمنة",
        strengthDescVeryStrong: "قوية جداً ومقاومة للهجمات",
        advancedTitle: "خيارات متقدمة",
        excludeSimilarLabel: "استبعاد الأحرف المتشابهة (i, l, 1, 0, o)",
        avoidDuplicatesLabel: "تجنب الأحرف المكررة",
        startLetterLabel: "بداية كلمة المرور بحرف",
        passwordPlaceholder: "سيتم عرض كلمة المرور هنا",
        security1: "توليد آمن",
        security2: "تشفير قوي",
        security3: "لا يتم التخزين",
        security4: "مقاوم للهجمات",
        generateText: "توليد كلمة مرور",
        regenerateText: "توليد جديدة",
        copyText: "نسخ كلمة المرور",
        copiedText: "تم النسخ!",
        footerText: "جميع كلمات المرور يتم توليدها على جهازك ولا يتم إرسالها إلى أي خادم. هذا الموقع مفتوح المصدر وآمن بنسبة 100%.",
        learnMore: "تعرف على المزيد",
        notificationCopied: "تم نسخ كلمة المرور إلى الحافظة",
        notificationError: "حدث خطأ أثناء النسخ"
      },
      en: {
        appTitle: "SecurePass Pro",
        appSubtitle: "Secure & Strong Password Generator",
        settingsTitle: "Password Settings",
        lowercaseLabel: "Lowercase letters (a-z)",
        uppercaseLabel: "Uppercase letters (A-Z)",
        numbersLabel: "Numbers (0-9)",
        symbolsLabel: "Special symbols (!@#$%)",
        lengthTitle: "Password Length",
        lengthLabel: "Length:",
        strengthTitle: "Password Strength",
        strengthLabel: "Strength:",
        strengthWeak: "Weak",
        strengthMedium: "Medium",
        strengthStrong: "Strong",
        strengthVeryStrong: "Very Strong",
        strengthDescWeak: "Not secure - Please increase length and settings",
        strengthDescMedium: "Good, can be improved",
        strengthDescStrong: "Strong and secure",
        strengthDescVeryStrong: "Very strong and attack-resistant",
        advancedTitle: "Advanced Options",
        excludeSimilarLabel: "Exclude similar characters (i, l, 1, 0, o)",
        avoidDuplicatesLabel: "Avoid duplicate characters",
        startLetterLabel: "Start with a letter",
        passwordPlaceholder: "Password will appear here",
        security1: "Secure Generation",
        security2: "Strong Encryption",
        security3: "No Storage",
        security4: "Attack Resistant",
        generateText: "Generate Password",
        regenerateText: "Generate New",
        copyText: "Copy Password",
        copiedText: "Copied!",
        footerText: "All passwords are generated on your device and are not sent to any server. This site is open source and 100% secure.",
        learnMore: "Learn More",
        notificationCopied: "Password copied to clipboard",
        notificationError: "Error copying password"
      }
    };

    // حالة التطبيق
    const state = {
      currentLang: 'ar',
      settings: {
        lowercase: true,
        uppercase: true,
        numbers: true,
        symbols: true,
        excludeSimilar: false,
        avoidDuplicates: false,
        startWithLetter: false
      },
      password: '',
      length: 16
    };

    // تهيئة العناصر
    const elements = {
      // النصوص
      appTitle: document.getElementById('app-title'),
      appSubtitle: document.getElementById('app-subtitle'),
      settingsTitle: document.getElementById('settings-title'),
      lowercaseLabel: document.getElementById('lowercase-label'),
      uppercaseLabel: document.getElementById('uppercase-label'),
      numbersLabel: document.getElementById('numbers-label'),
      symbolsLabel: document.getElementById('symbols-label'),
      lengthTitle: document.getElementById('length-title'),
      lengthLabel: document.getElementById('length-label'),
      strengthTitle: document.getElementById('strength-title'),
      strengthLabel: document.getElementById('strength-label'),
      advancedTitle: document.getElementById('advanced-title'),
      excludeSimilarLabel: document.getElementById('exclude-similar-label'),
      avoidDuplicatesLabel: document.getElementById('avoid-duplicates-label'),
      startLetterLabel: document.getElementById('start-letter-label'),
      passwordPlaceholder: document.getElementById('password-placeholder'),
      security1: document.getElementById('security-1'),
      security2: document.getElementById('security-2'),
      security3: document.getElementById('security-3'),
      security4: document.getElementById('security-4'),
      generateText: document.getElementById('generate-text'),
      regenerateText: document.getElementById('regenerate-text'),
      copyText: document.getElementById('copy-text'),
      footerText: document.getElementById('footer-text'),
      learnMore: document.getElementById('learn-more'),
      
      // العناصر التفاعلية
      langButtons: document.querySelectorAll('.lang-btn'),
      checkboxes: document.querySelectorAll('.checkbox'),
      lengthSlider: document.getElementById('length-slider'),
      lengthValue: document.getElementById('length-value'),
      passwordDisplay: document.getElementById('password-display'),
      passwordText: document.getElementById('password-text'),
      strengthText: document.getElementById('strength-text'),
      strengthBar: document.getElementById('strength-bar'),
      strengthDesc: document.getElementById('strength-desc'),
      generateBtn: document.getElementById('generate-btn'),
      regenerateBtn: document.getElementById('regenerate-btn'),
      copyBtn: document.getElementById('copy-btn'),
      advancedToggle: document.getElementById('advanced-toggle'),
      advancedContent: document.getElementById('advanced-content'),
      notification: document.getElementById('notification'),
      notificationText: document.getElementById('notification-text')
    };

    // تهيئة التطبيق
    function init() {
      // إعداد مستمعي الأحداث
      setupEventListeners();
      
      // تعيين اللغة الافتراضية
      setLanguage('ar');
      
      // توليد كلمة مرور أولية
      generatePassword();
      
      // تحديث واجهة المستخدم
      updateUI();
    }

    // إعداد مستمعي الأحداث
    function setupEventListeners() {
      // تبديل اللغة
      elements.langButtons.forEach(btn => {
        btn.addEventListener('click', () => {
          const lang = btn.dataset.lang;
          setLanguage(lang);
        });
      });

      // مربعات الاختيار
      elements.checkboxes.forEach(checkbox => {
        checkbox.addEventListener('click', () => {
          const setting = checkbox.dataset.setting;
          state.settings[setting] = !state.settings[setting];
          checkbox.classList.toggle('checked');
          
          // التحقق من أنه تم تحديد خيار واحد على الأقل
          validateSettings();
          generatePassword();
        });
      });

      // شريط التمرير للطول
      elements.lengthSlider.addEventListener('input', () => {
        state.length = parseInt(elements.lengthSlider.value);
        elements.lengthValue.textContent = state.length;
        generatePassword();
      });

      // أزرار التوليد
      elements.generateBtn.addEventListener('click', generatePassword);
      elements.regenerateBtn.addEventListener('click', generatePassword);

      // زر النسخ
      elements.copyBtn.addEventListener('click', copyPassword);

      // تبديل الخيارات المتقدمة
      elements.advancedToggle.addEventListener('click', () => {
        elements.advancedContent.classList.toggle('show');
        const icon = elements.advancedToggle.querySelector('i');
        icon.classList.toggle('fa-chevron-down');
        icon.classList.toggle('fa-chevron-up');
      });

      // تحديث التوجيه عند تغيير اللغة
      document.addEventListener('langChange', (e) => {
        document.documentElement.dir = e.detail.lang === 'ar' ? 'rtl' : 'ltr';
      });
    }

    // تعيين اللغة
    function setLanguage(lang) {
      state.currentLang = lang;
      
      // تحديث أزرار اللغة
      elements.langButtons.forEach(btn => {
        btn.classList.toggle('active', btn.dataset.lang === lang);
      });
      
      // تحديث جميع النصوص
      Object.keys(translations[lang]).forEach(key => {
        if (elements[key]) {
          elements[key].textContent = translations[lang][key];
        }
      });
      
      // تحديث اتجاه النص
      document.dispatchEvent(new CustomEvent('langChange', {
        detail: { lang }
      }));
      
      // إعادة حساب قوة كلمة المرور
      updatePasswordStrength();
    }

    // التحقق من الإعدادات
    function validateSettings() {
      const { lowercase, uppercase, numbers, symbols } = state.settings;
      if (!lowercase && !uppercase && !numbers && !symbols) {
        // إذا لم يتم تحديد أي خيار، نحدد الأحرف الصغيرة تلقائياً
        state.settings.lowercase = true;
        document.querySelector('[data-setting="lowercase"]').classList.add('checked');
        showNotification('يرجى تحديد خيار واحد على الأقل', 'error');
      }
    }

    // توليد كلمة مرور آمنة
    function generatePassword() {
      const { lowercase, uppercase, numbers, symbols, excludeSimilar, avoidDuplicates, startWithLetter } = state.settings;
      
      // مجموعات الأحرف
      let charSets = {
        lowercase: 'abcdefghijklmnopqrstuvwxyz',
        uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
        numbers: '0123456789',
        symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
      };
      
      // استبعاد الأحرف المتشابهة إذا طلب
      if (excludeSimilar) {
        charSets.lowercase = charSets.lowercase.replace(/[il]/g, '');
        charSets.uppercase = charSets.uppercase.replace(/[IL]/g, '');
        charSets.numbers = charSets.numbers.replace(/[01]/g, '');
      }
      
      // بناء مجموعة الأحرف النهائية
      let allChars = '';
      if (lowercase) allChars += charSets.lowercase;
      if (uppercase) allChars += charSets.uppercase;
      if (numbers) allChars += charSets.numbers;
      if (symbols) allChars += charSets.symbols;
      
      // إذا لم يكن هناك أحرف، نعود
      if (!allChars) {
        elements.passwordText.textContent = '';
        elements.passwordPlaceholder.style.display = 'block';
        return;
      }
      
      // توليد كلمة المرور باستخدام crypto API
      const array = new Uint32Array(state.length);
      window.crypto.getRandomValues(array);
      
      let password = '';
      let usedChars = new Set();
      
      for (let i = 0; i < state.length; i++) {
        let char;
        let attempts = 0;
        
        do {
          const randomIndex = array[i] % allChars.length;
          char = allChars[randomIndex];
          attempts++;
          
          // تجنب التكرار إذا طلب
          if (avoidDuplicates && usedChars.has(char) && attempts < 10) {
            // توليد فهرس جديد
            array[i] = Math.floor(Math.random() * 4294967295);
            continue;
          }
        } while (avoidDuplicates && usedChars.has(char) && attempts < 10);
        
        password += char;
        if (avoidDuplicates) usedChars.add(char);
      }
      
      // التأكد من بداية كلمة المرور بحرف إذا طلب
      if (startWithLetter) {
        const letters = (lowercase ? charSets.lowercase : '') + (uppercase ? charSets.uppercase : '');
        if (letters && !/[a-zA-Z]/.test(password[0])) {
          const randomIndex = Math.floor(Math.random() * letters.length);
          password = letters[randomIndex] + password.slice(1);
        }
      }
      
      state.password = password;
      updatePasswordDisplay();
      updatePasswordStrength();
    }

    // تحديث عرض كلمة المرور
    function updatePasswordDisplay() {
      elements.passwordText.textContent = state.password;
      elements.passwordPlaceholder.style.display = state.password ? 'none' : 'block';
    }

    // حساب قوة كلمة المرور
    function updatePasswordStrength() {
      const password = state.password;
      let score = 0;
      
      if (!password) {
        updateStrengthUI(0, 'weak');
        return;
      }
      
      // طول كلمة المرور
      if (password.length >= 8) score++;
      if (password.length >= 12) score++;
      if (password.length >= 16) score += 2;
      if (password.length >= 20) score += 2;
      
      // تنوع الأحرف
      if (/[a-z]/.test(password)) score++;
      if (/[A-Z]/.test(password)) score++;
      if (/[0-9]/.test(password)) score++;
      if (/[^A-Za-z0-9]/.test(password)) score++;
      
      // تعقيد إضافي
      if (password.length >= 8 && /[a-z]/.test(password) && /[A-Z]/.test(password) && /[0-9]/.test(password)) score++;
      if (password.length >= 12 && /[^A-Za-z0-9]/.test(password)) score += 2;
      
      // تحديد القوة
      let strength, percentage, description;
      
      if (score <= 3) {
        strength = translations[state.currentLang].strengthWeak;
        percentage = 25;
        description = translations[state.currentLang].strengthDescWeak;
      } else if (score <= 6) {
        strength = translations[state.currentLang].strengthMedium;
        percentage = 50;
        description = translations[state.currentLang].strengthDescMedium;
      } else if (score <= 9) {
        strength = translations[state.currentLang].strengthStrong;
        percentage = 75;
        description = translations[state.currentLang].strengthDescStrong;
      } else {
        strength = translations[state.currentLang].strengthVeryStrong;
        percentage = 100;
        description = translations[state.currentLang].strengthDescVeryStrong;
      }
      
      updateStrengthUI(percentage, strength.toLowerCase().replace(' ', '-'), description);
    }

    // تحديث واجهة مؤشر القوة
    function updateStrengthUI(percentage, strengthClass, description) {
      elements.strengthBar.className = 'strength-fill';
      elements.strengthBar.classList.add(`strength-${strengthClass}`);
      elements.strengthBar.style.width = `${percentage}%`;
      elements.strengthText.textContent = translations[state.currentLang][`strength${strengthClass.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join('')}`];
      elements.strengthDesc.textContent = description || '';
      
      // تحديث لون النص حسب القوة
      const colors = {
        'weak': '#ef4444',
        'medium': '#f59e0b',
        'strong': '#10b981',
        'very-strong': '#3b82f6'
      };
      elements.strengthText.style.color = colors[strengthClass] || colors.medium;
    }

    // نسخ كلمة المرور
    async function copyPassword() {
      if (!state.password) return;
      
      try {
        await navigator.clipboard.writeText(state.password);
        showNotification(translations[state.currentLang].notificationCopied);
        elements.copyText.innerHTML = `<i class="fas fa-check"></i> ${translations[state.currentLang].copiedText}`;
        elements.copyBtn.classList.add('btn-success');
        
        setTimeout(() => {
          elements.copyText.innerHTML = `<i class="far fa-copy"></i> ${translations[state.currentLang].copyText}`;
          elements.copyBtn.classList.remove('btn-success');
        }, 2000);
      } catch (err) {
        showNotification(translations[state.currentLang].notificationError, 'error');
      }
    }

    // عرض الإشعارات
    function showNotification(message, type = 'success') {
      elements.notificationText.textContent = message;
      elements.notification.className = 'notification';
      elements.notification.classList.add(type === 'error' ? 'error' : 'success');
      elements.notification.classList.add('show');
      
      setTimeout(() => {
        elements.notification.classList.remove('show');
      }, 3000);
    }

    // تحديث واجهة المستخدم
    function updateUI() {
      elements.lengthValue.textContent = state.length;
      elements.lengthSlider.value = state.length;
      
      // تحديث مربعات الاختيار
      Object.keys(state.settings).forEach(setting => {
        const checkbox = document.querySelector(`[data-setting="${setting}"]`);
        if (checkbox) {
          checkbox.classList.toggle('checked', state.settings[setting]);
        }
      });
    }

    // تشغيل التطبيق
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
